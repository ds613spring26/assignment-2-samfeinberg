---
title: "Lab_function_iterator_vector"
date: "`r Sys.Date()`"
Acknowledgement: "Thanks to Dr. David Gerard"
output: pdf_document
urlcolor: "blue"
params: 
  solutions: TRUE
format: html
editor: visual
author: Sam Feinberg
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = params$solutions, 
                      eval = params$solutions,
                      fig.height = 3, 
                      fig.width  = 6,
                      fig.align  = "center")
ggplot2::theme_set(ggplot2::theme_bw())
```

# Learning Objectives

-   Practice manipulating vectors.
-   Practice for loops.
-   Practice `purrr`.

# Exercise 1: Simulations

1.  Write a function that uses a for loop that, for each iteration, randomly draws 5 observations from an exponential distribution with rate parameter 1 (use `rexp()`) and calculates its mean. It should do this 10,000 times. Choose an appropriate plot to plot the distribution of means.

    ```{r}
    #| title: Exercise 1

    exponential_distribution_means <- function() {
      means <- numeric(10000)
      for (i in 1:10000) {
        sample <- rexp(5, rate = 1)
        means[i] <- mean(sample)
        }
      return(means)
      }

    results <- exponential_distribution_means() 
    results_df <- data.frame(means = results)

    library(tidyverse)

    results_df |>
      ggplot(aes(x = means)) +
      geom_histogram() +
      labs(
        title = "Distribution of Sample Means",
        subtitle = "10,000 Samples",
        x = "Mean",
        y = "Count"
           )

    ```

# Exercise 2: Star Trek

For this exercise, load in the following dataset.

```{r, message = FALSE, eval = TRUE, echo = TRUE}
library(tidyverse)
library(lubridate)
```

```{r, echo = TRUE, eval = TRUE}
st <- list(
  franchise = "Star Trek",
  series = c("TOS", "TNG", "DS9", "VOY", "ENT"),
  starship = tribble(~ID,         ~class,         ~name,       ~length,  ~launched,
                     ##----------/---------------/------------/---------/----------
                     "NCC-1701",  "constitution", "Enterprise", 288.646, 2245,
                     "NCC-1701D", "galaxy",       "Enterprise", 642.5,   2361,
                     "NX-74205",  "defiant",      "Defiant",    170,     2370,
                     "NCC-74656", "intrepid",     "Voyager",    343,     2371),
  captain = tribble(~firstname,  ~lastname, ~ship,       ~drink,
                    ##----------/----------/------------/----------
                    "James",     "Kirk",    "NCC-1701",  "brandy",
                    "Jean-luc",  "Picard",  "NCC-1701D", "tea",
                    "Benjamin",  "Sisko",   "NX-74205",  "coffee",
                    "Katherine", "Janeway", "NCC-74656", "coffee"),
  age = as.duration(today() - ymd(19660908))
)
```

## 1. Use an appropriate function to see the components of `st` in a concise way.

```{r}
#| title: Exercise 2, Part 1
#| include: true

head(st)

```

## 2. Use R code to determine the class of each element of `st`.

```{r}
#| title: Exercise 2, Part 2

sapply(st, class)

```

## 3. It seems that `starship` and `captain` can be merged into one data frame. Do this now.

```         
Your `st` list should now look like this:
```

```{r}
#| title: Exercise 2, Part 3

st$captain
st$starship |>
  rename(ship = ID) |>
  left_join(st$captain)
```

# Exercise 3: Diamonds

## 1. Load in the `diamonds` data frame from the ggplot2 package.

```{r}
#| title: Exercise 3, Part 1

head(diamonds)

```

## 2. Calculate summary statistics (using `summary()`) for all quantitative variables.

```{r}
#| title: Exercise 3, Part 2

summary(diamonds)

```

## 3. Fit a linear model of `price` on `depth` and extract the $p$-value for the regression coefficient of `depth`

```{r}
#| title: Exercise 3, Part 3

model <- lm(price ~ depth, data = diamonds)
p_val <- summary(model)$coefficients["depth", "Pr(>|t|)"]
p_val

```

## 4. Plot `depth` vs `price`, faceting by `color`, including an OLS line. Do the $p$-values in the previous question roughly match what you would expect based on the plots?

```{r}
#| title: Exercise 3, Part 4

diamonds |>
  ggplot(aes(x = depth, y = price)) +
  geom_point(alpha = 0.05) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ color) +
  labs(
    title = "Depth vs Price by Diamond Color",
    x = "Depth",
    y = "Price"
  )

## Based on these plots, the p-value from the last question is in line with what I would expect.

```
